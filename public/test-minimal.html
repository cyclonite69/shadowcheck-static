<!DOCTYPE html>
<html>
<head>
    <title>Minimal Test</title>
    <style>
        body { background: #1e293b; color: #fff; font-family: sans-serif; padding: 20px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #444; padding: 8px; text-align: left; }
        th { background: #334155; }
    </style>
</head>
<body>
    <h1>Minimal Networks Test</h1>
    <div id="status">Initializing...</div>
    <div id="debug"></div>
    <table id="test-table">
        <thead><tr><th>BSSID</th><th>SSID</th><th>Type</th></tr></thead>
        <tbody></tbody>
    </table>

    <script>
        const API_BASE = Object.freeze(`${window.location.protocol}//${window.location.hostname}:3001/api`);
        const status = document.getElementById('status');
        const debug = document.getElementById('debug');
        const tbody = document.querySelector('#test-table tbody');

        function log(msg) {
            console.log(msg);
            debug.innerHTML += msg + '<br>';
        }

        async function test() {
            try {
                log('1. API_BASE: ' + API_BASE);
                status.textContent = 'Fetching...';
                
                log('2. Fetching from API...');
                const url = `${API_BASE}/networks?page=1&limit=5`;
                log('3. URL: ' + url);
                
                const response = await fetch(url);
                log('4. Response status: ' + response.status);
                
                if (!response.ok) {
                    throw new Error('HTTP ' + response.status);
                }
                
                const data = await response.json();
                log('5. Data received: ' + data.networks.length + ' networks');
                log('6. Total: ' + data.total);
                
                status.textContent = `Loaded ${data.networks.length} networks`;
                
                tbody.innerHTML = '';
                data.networks.forEach((net, i) => {
                    log(`7.${i} Rendering: ${net.bssid}`);
                    const row = tbody.insertRow();
                    row.insertCell().textContent = net.bssid;
                    row.insertCell().textContent = net.ssid || '(hidden)';
                    row.insertCell().textContent = net.type;
                });
                
                log('8. ✅ SUCCESS!');
                
            } catch (error) {
                log('❌ ERROR: ' + error.message);
                status.textContent = 'Error: ' + error.message;
                status.style.color = '#ef4444';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            log('0. DOM Ready');
            test();
        });
    </script>
</body>
</html>
