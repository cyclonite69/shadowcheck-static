<!DOCTYPE html>
<html>
<head>
    <title>S22 Ultra Sensor Data</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>S22 Ultra All Sensors</h1>
    <button onclick="captureAll()">Capture All Sensor Data</button>
    <pre id="output"></pre>
    
    <script>
    async function captureAll() {
        const data = {};
        const output = document.getElementById('output');
        
        // GPS
        if (navigator.geolocation) {
            await new Promise((resolve) => {
                navigator.geolocation.getCurrentPosition((pos) => {
                    data.gps = {
                        latitude: pos.coords.latitude,
                        longitude: pos.coords.longitude,
                        altitude: pos.coords.altitude,
                        altitudeAccuracy: pos.coords.altitudeAccuracy,
                        accuracy: pos.coords.accuracy,
                        heading: pos.coords.heading,
                        speed: pos.coords.speed,
                        timestamp: pos.timestamp
                    };
                    resolve();
                }, resolve, { enableHighAccuracy: true, timeout: 30000 });
            });
        }
        
        // Device Orientation (compass, gyro)
        if (typeof DeviceOrientationEvent !== 'undefined') {
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                await DeviceOrientationEvent.requestPermission();
            }
            await new Promise((resolve) => {
                window.addEventListener('deviceorientation', (e) => {
                    data.orientation = {
                        alpha: e.alpha, // compass
                        beta: e.beta,   // tilt front-back
                        gamma: e.gamma, // tilt left-right
                        absolute: e.absolute
                    };
                    resolve();
                }, { once: true });
                setTimeout(resolve, 1000);
            });
        }
        
        // Device Motion (accelerometer, gyroscope)
        if (typeof DeviceMotionEvent !== 'undefined') {
            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                await DeviceMotionEvent.requestPermission();
            }
            await new Promise((resolve) => {
                window.addEventListener('devicemotion', (e) => {
                    data.motion = {
                        acceleration: e.acceleration,
                        accelerationIncludingGravity: e.accelerationIncludingGravity,
                        rotationRate: e.rotationRate,
                        interval: e.interval
                    };
                    resolve();
                }, { once: true });
                setTimeout(resolve, 1000);
            });
        }
        
        // Ambient Light
        if ('AmbientLightSensor' in window) {
            try {
                const sensor = new AmbientLightSensor();
                await sensor.start();
                data.ambientLight = sensor.illuminance;
            } catch(e) {}
        }
        
        // Battery
        if ('getBattery' in navigator) {
            const battery = await navigator.getBattery();
            data.battery = {
                level: battery.level,
                charging: battery.charging,
                chargingTime: battery.chargingTime,
                dischargingTime: battery.dischargingTime
            };
        }
        
        // Network
        if ('connection' in navigator) {
            data.network = {
                effectiveType: navigator.connection.effectiveType,
                downlink: navigator.connection.downlink,
                rtt: navigator.connection.rtt,
                saveData: navigator.connection.saveData
            };
        }
        
        // Screen
        data.screen = {
            width: screen.width,
            height: screen.height,
            orientation: screen.orientation?.type,
            colorDepth: screen.colorDepth,
            pixelRatio: window.devicePixelRatio
        };
        
        // Send to server
        await fetch('/api/location-markers/home', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        
        output.textContent = JSON.stringify(data, null, 2);
    }
    </script>
</body>
</html>
